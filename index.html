<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Sistema de Clientes</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
body {
    font-family: 'Poppins', sans-serif;
    transition: all 0.3s ease;
    background: linear-gradient(135deg, #667eea, #764ba2);
}

.container { animation: fadeIn 0.6s ease-in-out; }

.card {
    border: none;
    border-radius: 18px;
    transition: 0.3s ease;
}

.card-header {
    border-radius: 18px 18px 0 0 !important;
    font-weight: 600;
}

.btn {
    border-radius: 12px;
    transition: 0.3s ease;
}

.btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 18px rgba(0,0,0,0.25);
}

.table {
    border-radius: 12px;
    overflow: hidden;
}

.form-control { border-radius: 10px; }

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(15px); }
    to { opacity: 1; transform: translateY(0); }
}

/* DARK MODE */
.dark-mode {
    background: linear-gradient(135deg, #1e1e2f, #121212) !important;
    color: white !important;
}

.dark-mode .card {
    background-color: rgba(30,30,30,0.95);
    color: white;
}

.dark-mode .form-control {
    background-color: #2a2a2a;
    color: white;
    border: 1px solid #444;
}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="telaLogin" class="container mt-5" style="max-width:420px;">
    <div class="card shadow-lg">
        <div class="card-header bg-dark text-white d-flex justify-content-between">
            <span>游댏 Login do Sistema</span>
            <button class="btn btn-secondary btn-sm" onclick="toggleDarkMode()">游깿</button>
        </div>
        <div class="card-body p-4">
            <input type="text" id="usuarioLogin" class="form-control mb-3" placeholder="Usu치rio">
            <input type="password" id="senhaLogin" class="form-control mb-3" placeholder="Senha">
            <button class="btn btn-success w-100 mb-2" onclick="login()">Entrar</button>
            <button class="btn btn-outline-light w-100" onclick="mostrarCadastro()">Criar Conta</button>
        </div>
    </div>
</div>

<!-- CADASTRO -->
<div id="telaCadastro" class="container mt-5" style="max-width:420px; display:none;">
    <div class="card shadow-lg">
        <div class="card-header bg-primary text-white text-center">
            游녻 Criar Usu치rio
        </div>
        <div class="card-body p-4">
            <input type="text" id="novoUsuario" class="form-control mb-3" placeholder="Novo Usu치rio">
            <input type="password" id="novaSenha" class="form-control mb-3" placeholder="Nova Senha">
            <button class="btn btn-success w-100 mb-2" onclick="criarUsuario()">Cadastrar</button>
            <button class="btn btn-secondary w-100" onclick="voltarLogin()">Voltar</button>
        </div>
    </div>
</div>

<!-- SISTEMA -->
<div id="sistema" style="display:none;">
<div class="container mt-5">
    <div class="card shadow-lg">
        <div class="card-header bg-primary text-white d-flex justify-content-between">
            <span>游늶 Cadastro de Clientes</span>
            <div>
                <span id="usuarioLogado" class="me-3"></span>
                <button class="btn btn-secondary btn-sm me-2" onclick="toggleDarkMode()">游깿</button>
                <button class="btn btn-danger btn-sm" onclick="logout()">Sair</button>
            </div>
        </div>

        <div class="card-body p-4">

            <div class="row g-3">
                <div class="col-md-5">
                    <input type="text" id="nome" class="form-control" placeholder="Nome">
                </div>
                <div class="col-md-5">
                    <input type="email" id="email" class="form-control" placeholder="Email">
                </div>
                <div class="col-md-2">
                    <button onclick="adicionar()" class="btn btn-success w-100">Adicionar</button>
                </div>
            </div>

            <hr>

            <div class="row mb-3">
                <div class="col-md-6">
                    <input type="text" id="busca" class="form-control"
                        placeholder="游댌 Buscar por nome ou email..."
                        onkeyup="buscar()">
                </div>
            </div>

            <table class="table table-striped align-middle">
                <thead class="table-dark">
                    <tr>
                        <th>ID</th>
                        <th>Nome</th>
                        <th>Email</th>
                        <th>A칞칫es</th>
                    </tr>
                </thead>
                <tbody id="tabelaClientes"></tbody>
            </table>

        </div>
    </div>
</div>
</div>

<!-- MODAL EDITAR -->
<div class="modal fade" id="modalEditar" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header bg-warning">
        <h5 class="modal-title">九勇 Editar Cliente</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="editId">
        <input type="text" id="editNome" class="form-control mb-3" placeholder="Nome">
        <input type="email" id="editEmail" class="form-control" placeholder="Email">
      </div>
      <div class="modal-footer">
        <button class="btn btn-success" onclick="salvarEdicao()">Salvar</button>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
// DARK MODE
function toggleDarkMode() {
    document.body.classList.toggle("dark-mode");
}

// BANCO
let usuarios = JSON.parse(localStorage.getItem("usuarios")) || [];
let clientes = JSON.parse(localStorage.getItem("clientes")) || [];

// TELAS
function mostrarCadastro() {
    telaLogin.style.display = "none";
    telaCadastro.style.display = "block";
}

function voltarLogin() {
    telaCadastro.style.display = "none";
    telaLogin.style.display = "block";
}

function mostrarSistema() {
    telaLogin.style.display = "none";
    telaCadastro.style.display = "none";
    sistema.style.display = "block";
    usuarioLogado.innerText = "游녻 " + localStorage.getItem("logado");
}

function verificarLogin() {
    if (localStorage.getItem("logado")) mostrarSistema();
}

// USU츼RIO
function criarUsuario() {
    let usuario = novoUsuario.value;
    let senha = novaSenha.value;

    if (!usuario || !senha) return alert("Preencha todos os campos!");
    if (usuarios.find(u => u.usuario === usuario)) return alert("Usu치rio j치 existe!");

    usuarios.push({ usuario, senha });
    localStorage.setItem("usuarios", JSON.stringify(usuarios));
    alert("Usu치rio criado com sucesso!");
    voltarLogin();
}

function login() {
    let usuario = usuarioLogin.value;
    let senha = senhaLogin.value;

    let usuarioValido = usuarios.find(u => u.usuario === usuario && u.senha === senha);

    if (usuarioValido) {
        localStorage.setItem("logado", usuario);
        mostrarSistema();
    } else {
        alert("Usu치rio ou senha inv치lidos!");
    }
}

function logout() {
    localStorage.removeItem("logado");
    location.reload();
}

// CRUD
function salvarLocal() {
    localStorage.setItem("clientes", JSON.stringify(clientes));
}

function adicionar() {
    if (!nome.value || !email.value) return alert("Preencha todos os campos!");

    let id = clientes.length > 0 ? clientes[clientes.length - 1].id + 1 : 1;
    clientes.push({ id, nome: nome.value, email: email.value });

    salvarLocal();
    atualizarTabela();

    nome.value = "";
    email.value = "";
}

function atualizarTabela(lista = clientes) {
    tabelaClientes.innerHTML = "";

    lista.forEach(cliente => {
        tabelaClientes.innerHTML += `
            <tr>
                <td>${cliente.id}</td>
                <td>${cliente.nome}</td>
                <td>${cliente.email}</td>
                <td>
                    <button class="btn btn-warning btn-sm me-1" onclick="abrirEditar(${cliente.id})">Editar</button>
                    <button class="btn btn-danger btn-sm" onclick="deletar(${cliente.id})">Excluir</button>
                </td>
            </tr>
        `;
    });
}

function abrirEditar(id) {
    let cliente = clientes.find(c => c.id === id);

    editId.value = cliente.id;
    editNome.value = cliente.nome;
    editEmail.value = cliente.email;

    let modal = new bootstrap.Modal(document.getElementById('modalEditar'));
    modal.show();
}

function salvarEdicao() {
    let id = parseInt(editId.value);

    let cliente = clientes.find(c => c.id === id);

    cliente.nome = editNome.value;
    cliente.email = editEmail.value;

    salvarLocal();
    atualizarTabela();

    bootstrap.Modal.getInstance(document.getElementById('modalEditar')).hide();
}

function buscar() {
    let termo = busca.value.toLowerCase();

    let filtrados = clientes.filter(cliente =>
        cliente.nome.toLowerCase().includes(termo) ||
        cliente.email.toLowerCase().includes(termo)
    );

    atualizarTabela(filtrados);
}

function deletar(id) {
    clientes = clientes.filter(c => c.id !== id);
    salvarLocal();
    atualizarTabela();
}

verificarLogin();
atualizarTabela();
</script>

</body>
</html>
